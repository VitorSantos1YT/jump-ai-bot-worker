export default {
  async fetch(request, env) {
    const url = new URL(request.url);
    if (url.pathname === '/webhook') {
      if (request.method !== 'POST') return new Response('OK');
      const body = await request.json();
      const chatId = body?.message?.chat?.id;
      const text = body?.message?.text || "Mensagem sem texto";
      if (chatId && env.TELEGRAM_BOT_TOKEN) {
        await fetch(`https://api.telegram.org/bot${env.TELEGRAM_BOT_TOKEN}/sendMessage`, {
          method: "POST",
          headers: {"Content-Type":"application/json"},
          body: JSON.stringify({chat_id: chatId, text: `Você disse: ${text}`})
        });
      }
      return new Response("OK");
    }
    if (url.pathname === '/') {
      return new Response("Jump-AI Bot worker está rodando.", { status: 200 });
    }
    return new Response("Not found", { status: 404 });
  }
}